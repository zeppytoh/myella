---
// Assets
import { Image } from "astro:assets";
// Fundations
import BaseLayout from "@/layouts/BaseLayout.astro";
import Text from "@/components/foundations/elements/Text.astro";
import Wrapper from "@/components/foundations/containers/Wrapper.astro";
// Components
import BlogEntry from "@/components/blog/BlogEntry.astro";
// Load all posts
import { getCollection } from "astro:content";
// Content
const allPosts = await getCollection("posts");
// Get the team slug from the URL
const teamSlug = Astro.url.pathname.split("/").filter(Boolean).pop();
// Filter posts by this team (based on slug)
const relatedPosts = allPosts.filter((post) => post.data.team === teamSlug);
const { frontmatter } = Astro.props;
---

<BaseLayout>
  <section>
    <Wrapper variant="standard" class="py-32">
      <div class="max-w-md mx-auto text-center text-balance">
        <Text
          tag="h1"
          variant="displaySM"
          class="font-medium tracking-tight text-base-900"
        >
          {frontmatter.name}
        </Text>

        <Text tag="p" variant="textBase" class="mt-4 text-black">
          {frontmatter.role}
        </Text>

        <div class="flex items-center justify-center mt-8 gap-2">
          <a
            href={frontmatter.socials.twitter}
            class="text-sm text-base-600 hover:text-base-800 duration-300"
            aria-label="X"
          >
            Twitter
          </a>
          <a
            href={frontmatter.socials.linkedin}
            class="text-sm text-base-600 hover:text-base-800 duration-300"
            aria-label="LinkedIn"
          >
            Linkedin
          </a>
          <a
            href={frontmatter.socials.email}
            class="text-sm text-base-600 hover:text-base-800 duration-300"
            aria-label="Email"
          >
            Email
          </a>
          <a
            href={frontmatter.socials.website}
            class="text-sm text-base-600 hover:text-base-800 duration-300"
            aria-label="Website"
          >
            Website
          </a>
        </div>
        <Image
          width={1000}
          height={800}
          alt={frontmatter.image.alt}
          src={frontmatter.image.url}
          class="object-cover object-center mt-8 size-full max-h-96 lg:col-span-2 rounded-xl"
        />
      </div>
      {
        frontmatter.bio && (
          <div class="flex flex-col max-w-md mx-auto mt-8 gap-2">
            {frontmatter.bio.split("\n").map((paragraph) => (
              <Text tag="p" variant="textSM" class="text-base-500">
                {paragraph}
              </Text>
            ))}
          </div>
        )
      }
    </Wrapper>
  </section>
  {
    relatedPosts.length > 0 && (
      <section>
        <Wrapper
          variant="standard"
          class="py-12 border-t-2 border-black bg-yellow"
        >
          <div>
            <Text
              tag="h2"
              variant="displayMD"
              class="font-medium tracking-tight  text-base-900"
            >
              More posts from{" "}
              <span class="capitalize">{teamSlug.replace(/-/g, " ")}</span>
            </Text>

            <div class="mt-8 grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
              {relatedPosts.map((post) => (
                <BlogEntry post={post} />
              ))}
            </div>
          </div>
        </Wrapper>
      </section>
    )
  }
</BaseLayout>
